import asyncio
import aiohttp
from time import perf_counter

nums = [192507, 192506, 192505, 192504, 192503, 192502, 192501, 192500, 192499, 192498, 192497, 192496, 192495, 192494, 192493, 192492, 192491, 192490, 192489, 192488, 192487, 192486, 192485, 192484, 192483, 192482, 192481, 192480, 192479, 192478, 192477, 192476, 192475, 192474, 192473, 192472, 192471, 192470, 192469, 192468, 192467, 192466, 192465, 192464, 192463, 192462, 192461, 192460, 192459, 192458, 192457, 192456, 192455, 192454, 192453, 192452, 192451, 192450, 192449, 192448, 192447, 192446, 192445, 192444, 192443, 192442, 192441, 192440, 192439, 192438, 192437, 192436, 192435, 192434, 192433, 192432, 192431, 192430, 192429, 192428, 192427, 192426, 192425, 192424, 192423, 192422, 192421, 192420, 192419, 192418, 192417, 192416, 192415, 192414, 192413, 192412, 192411, 192410, 192409, 192408, 192407, 192406, 192405, 192404, 192403, 192402, 192401, 192400, 192399, 192398, 192397, 192396, 192395, 192394, 192393, 192392, 192391, 192390, 192389, 192388, 192387, 192386, 192385, 192384, 192383, 192382, 192381, 192380, 192379, 192378, 192377, 192376, 192375, 192374, 192373, 192372, 192371, 192370, 192369, 192368, 192367, 192366, 192365, 192364, 192363, 192362, 192361, 192360, 192359, 192358, 192357, 192356, 192355, 192354, 192353, 192352, 192351, 192350, 192349, 192348, 192347, 192346, 192345, 192344, 192343, 192342, 192341, 192340, 192339, 192338, 192337, 192336, 192335, 192334, 192333, 192332, 192331, 192330, 192329, 192328, 192327, 192326, 192325, 192324, 192323, 192322, 192321, 192320, 192319, 192318, 192317, 192316, 192315, 192314, 192313, 192312, 192311, 192310, 192309, 192308, 192307, 192306, 192305, 192304, 192303, 192302, 192301, 192300, 192299, 192298, 192297, 192296, 192295, 192294, 192293, 192292, 192291, 192290, 192289, 192288, 192287, 192286, 192285, 192284, 192283, 192282, 192281, 192280, 192279, 192278, 192277, 192276, 192275, 192274, 192273, 192272, 192271, 192270, 192269, 192268, 192267, 192266, 192265, 192264, 192263, 192262, 192261, 192260, 192259, 192258, 192257, 192256, 192255, 192254, 192253, 192252, 192251, 192250, 192249, 192248, 192247, 192246, 192245, 192244, 192243, 192242, 192241, 192240, 192239, 192238, 192237, 192236, 192235, 192234, 192233, 192232, 192231, 192230, 192229, 192228, 192227, 192226, 192225, 192224, 192223, 192222, 192221, 192220, 192219, 192218, 192217, 192216, 192215, 192214, 192213, 192212, 192211, 192210, 192209, 192208, 192207, 192206, 192205, 192204, 192203, 192202, 192201, 192200, 192199, 192198, 192197, 192196, 192195, 192194, 192193, 192192, 192191, 192190, 192189, 192188, 192187, 192186, 192185, 192184, 192183, 192182, 192181, 192180, 192179, 192178, 192177, 192176, 192175, 192174, 192173, 192172, 192171, 192170, 192169, 192168, 192167, 192166, 192165, 192164, 192163, 192162, 192161, 192160, 192159, 192158, 192157, 192156, 192155, 192154, 192153, 192152, 192151, 192150, 192149, 192148, 192147, 192146, 192145, 192144, 192143, 192142, 192141, 192140, 192139, 192138, 192137, 192136, 192135, 192134, 192133, 192132, 192131, 192130, 192129, 192128, 192127, 192126, 192125, 192124, 192123, 192122, 192121, 192120, 192119, 192118, 192117, 192116, 192115, 192114, 192113, 192112, 192111, 192110, 192109, 192108, 192107, 192106, 192105, 192104, 192103, 192102]
base_url = "https://www.tenable.com/_next/data/-HmMcqDTVg6G84rp85r9U/en/plugins/nessus/"

async def fetch_url(session, num):
    url = f"{base_url}{num}.json?type=nessus&id={num}"
    async with session.get(url) as response:
        data = await response.json()
        return data.get("pageProps").get("plugin")
    
async def async_version(nums):
    async with aiohttp.ClientSession() as session:
        tasks = [fetch_url(session, num) for num in nums]
        return await asyncio.gather(*tasks)

async def main():
    start = perf_counter()
    await async_version(nums)
    stop = perf_counter()
    print("time taken:", stop - start)

asyncio.run(main())







'''
import requests as request
from time import perf_counter
#Async & Await

nums = [192507, 192506, 192505, 192504, 192503, 192502, 192501, 192500, 192499, 192498, 192497, 192496, 192495, 192494, 192493, 192492, 192491, 192490, 192489, 192488, 192487, 192486, 192485, 192484, 192483, 192482, 192481, 192480, 192479, 192478, 192477, 192476, 192475, 192474, 192473, 192472, 192471, 192470, 192469, 192468, 192467, 192466, 192465, 192464, 192463, 192462, 192461, 192460, 192459, 192458, 192457, 192456, 192455, 192454, 192453, 192452, 192451, 192450, 192449, 192448, 192447, 192446, 192445, 192444, 192443, 192442, 192441, 192440, 192439, 192438, 192437, 192436, 192435, 192434, 192433, 192432, 192431, 192430, 192429, 192428, 192427, 192426, 192425, 192424, 192423, 192422, 192421, 192420, 192419, 192418, 192417, 192416, 192415, 192414, 192413, 192412, 192411, 192410, 192409, 192408, 192407, 192406, 192405, 192404, 192403, 192402, 192401, 192400, 192399, 192398, 192397, 192396, 192395, 192394, 192393, 192392, 192391, 192390, 192389, 192388, 192387, 192386, 192385, 192384, 192383, 192382, 192381, 192380, 192379, 192378, 192377, 192376, 192375, 192374, 192373, 192372, 192371, 192370, 192369, 192368, 192367, 192366, 192365, 192364, 192363, 192362, 192361, 192360, 192359, 192358, 192357, 192356, 192355, 192354, 192353, 192352, 192351, 192350, 192349, 192348, 192347, 192346, 192345, 192344, 192343, 192342, 192341, 192340, 192339, 192338, 192337, 192336, 192335, 192334, 192333, 192332, 192331, 192330, 192329, 192328, 192327, 192326, 192325, 192324, 192323, 192322, 192321, 192320, 192319, 192318, 192317, 192316, 192315, 192314, 192313, 192312, 192311, 192310, 192309, 192308, 192307, 192306, 192305, 192304, 192303, 192302, 192301, 192300, 192299, 192298, 192297, 192296, 192295, 192294, 192293, 192292, 192291, 192290, 192289, 192288, 192287, 192286, 192285, 192284, 192283, 192282, 192281, 192280, 192279, 192278, 192277, 192276, 192275, 192274, 192273, 192272, 192271, 192270, 192269, 192268, 192267, 192266, 192265, 192264, 192263, 192262, 192261, 192260, 192259, 192258, 192257, 192256, 192255, 192254, 192253, 192252, 192251, 192250, 192249, 192248, 192247, 192246, 192245, 192244, 192243, 192242, 192241, 192240, 192239, 192238, 192237, 192236, 192235, 192234, 192233, 192232, 192231, 192230, 192229, 192228, 192227, 192226, 192225, 192224, 192223, 192222, 192221, 192220, 192219, 192218, 192217, 192216, 192215, 192214, 192213, 192212, 192211, 192210, 192209, 192208, 192207, 192206, 192205, 192204, 192203, 192202, 192201, 192200, 192199, 192198, 192197, 192196, 192195, 192194, 192193, 192192, 192191, 192190, 192189, 192188, 192187, 192186, 192185, 192184, 192183, 192182, 192181, 192180, 192179, 192178, 192177, 192176, 192175, 192174, 192173, 192172, 192171, 192170, 192169, 192168, 192167, 192166, 192165, 192164, 192163, 192162, 192161, 192160, 192159, 192158, 192157, 192156, 192155, 192154, 192153, 192152, 192151, 192150, 192149, 192148, 192147, 192146, 192145, 192144, 192143, 192142, 192141, 192140, 192139, 192138, 192137, 192136, 192135, 192134, 192133, 192132, 192131, 192130, 192129, 192128, 192127, 192126, 192125, 192124, 192123, 192122, 192121, 192120, 192119, 192118, 192117, 192116, 192115, 192114, 192113, 192112, 192111, 192110, 192109, 192108, 192107, 192106, 192105, 192104, 192103, 192102]
base_url =" https://www.tenable.com/_next/data/cdt8HMnT5b0hf8g0Ld9M0/en/plugins/nessus/192507.json?type=nessus&id="
urls=[]

for num in nums:
    urls.append(base_url + str(num))


def sync_version(urls):
    for url in urls:
        r =request.get(f'{url}')
        #r =request.get(f'http://127.0.0.1:8000/items/{url}')
        print(r.json())

start = perf_counter()
sync_version(urls)
stop = perf_counter()
print("time taken:",stop - start)

'''
